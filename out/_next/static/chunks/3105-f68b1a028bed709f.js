"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3105],{3105:function(e,n,r){r.r(n);var t=r(34051),i=r.n(t),a=r(85893),o=r(67294),s=r(58826),l=r(83321),c=r(11496),u=r(50135),d=r(15861),f=r(79172),p=r(94054),m=r(56815),x=r(74231),h=r(95496),g=r(42283),v=r(42734),b=r(50657),j=r(37645),y=r(6514),Z=r(31425),w=r(58951),_=r(74931),k=r(33841),P=r(18360),C=r(57709),S=r(22224),M=r(86886),O=r(5370),I=r(91453),D=r(18043);function T(e,n,r,t,i,a,o){try{var s=e[a](o),l=s.value}catch(c){return void r(c)}s.done?n(l):Promise.resolve(l).then(t,i)}function z(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function o(e){T(a,t,i,o,s,"next",e)}function s(e){T(a,t,i,o,s,"throw",e)}o(void 0)}))}}function W(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function B(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){W(e,n,r[n])}))}return e}var N=(0,c.ZP)(f.Z)((function(e){var n=e.theme;return{display:"flex",alignItems:"center",padding:n.spacing(3,4),justifyContent:"space-between",backgroundColor:n.palette.background.default}})),E=x.Ry().shape({logistic_id:x.Rx().typeError("\u0628\u0647 \u062f\u0631\u0633\u062a\u06cc \u0648\u0627\u0631\u062f \u0646\u0645\u0627\u06cc\u06cc\u062f ").required("\u0641\u06cc\u0644\u062f \u0627\u0644\u0632\u0627\u0645\u06cc").min(1,"\u0641\u06cc\u0644\u062f \u0627\u0644\u0632\u0627\u0645\u06cc"),manifest_number:x.Rx().typeError("\u0628\u0647 \u062f\u0631\u0633\u062a\u06cc \u0648\u0627\u0631\u062f \u0646\u0645\u0627\u06cc\u06cc\u062f ").required("\u0641\u06cc\u0644\u062f \u0627\u0644\u0632\u0627\u0645\u06cc").min(1,"\u0641\u06cc\u0644\u062f \u0627\u0644\u0632\u0627\u0645\u06cc")});n.default=function(e){var n=e.open,r=e.toggle,t=e.setChange,c=e.user,x=e.showUser,T=(0,o.useState)(!1),W=T[0],A=T[1],F={logistic_id:0,manifest_number:0},R=c||F,G=(0,g.cI)({defaultValues:R,mode:"onChange",resolver:(0,h.X)(E)}),q=G.reset,U=G.control,H=G.handleSubmit,Q=G.setError,L=G.formState.errors,V=(0,o.useState)([]),X=V[0],J=V[1],K=function(){r(),q(F)},Y=(0,o.useState)([]),$=Y[0],ee=Y[1],ne=function(){var e=z(i().mark((function e(n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==X.length){e.next=3;break}return _.ZP.error("\u062d\u062f\u0627\u0642\u0644 \u06f1 \u0628\u0627\u0631\u0646\u0627\u0645\u0647 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f"),e.abrupt("return");case 3:r=X.flatMap((function(e){return $.find((function(n){return n.id===e})).generated_id})),_.ZP.promise((0,I.registerUser)(B({},n,{barname_ids:r})).then((function(){t(!0),K()})),{loading:"\u062f\u0631 \u062d\u0627\u0644 \u0627\u06cc\u062c\u0627\u062f \u0645\u0627\u0646\u06cc\u0641\u0633\u062a",success:"\u0645\u0627\u0646\u06cc\u0641\u0633\u062a \u0627\u06cc\u062c\u0627\u062f \u0634\u062f",error:function(e){var n,r,t,i;return(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)?null===(t=e.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.message:"\u062e\u0637\u0627\u06cc\u06cc \u0631\u062e \u062f\u0627\u062f\u0647 \u0627\u0633\u062a."}});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),re=(0,o.useState)([]),te=re[0],ie=re[1];return(0,o.useEffect)((function(){O.Z.get("logistics/",{},{Authorization:"Bearer ".concat(window.localStorage.getItem("access_Token"))}).then(function(){var e=z(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=n.data.logistics?ie(n.data.logistics):ie([]);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){Q("logistic_id",{type:"custom",message:e.response.data.message}),_.ZP.error("\u062e\u0637\u0627 \u062f\u0631 \u062f\u0631\u06cc\u0627\u0641\u062a \u0627\u0637\u0644\u0627\u0639\u0627\u062a.\u0644\u0637\u0641\u0627 \u0645\u062c\u062f\u062f \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f")}))}),[]),(0,a.jsxs)(s.ZP,{open:n,anchor:"left",variant:"temporary",onClose:K,ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paper":{width:{xs:"100%",sm:"100%",lg:"80%",xl:"80%"}}},children:[(0,a.jsxs)(N,{children:[(0,a.jsx)(d.Z,{variant:"h6",children:"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0644\u0627\u062c\u0633\u062a\u06cc\u06a9"}),(0,a.jsx)(v.Z,{fontSize:"small",onClick:K,sx:{cursor:"pointer"}})]}),(0,a.jsx)(f.Z,{sx:{p:5,"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"rgba(76,78,100,0.87)"},"& \t.MuiInputLabel-root.Mui-disabled":{WebkitTextFillColor:"rgba(76,78,100,0.87)"}},children:(0,a.jsx)("form",{onSubmit:H(ne),children:(0,a.jsxs)(M.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(M.ZP,{item:!0,xs:12,sm:12,md:6,lg:3,xl:3,children:(0,a.jsxs)(p.Z,{fullWidth:!0,sx:{mb:4},children:[(0,a.jsx)(g.Qr,{name:"manifest_number",control:U,rules:{required:!0},render:function(e){var n=e.field,r=n.value,t=n.onChange,i=n.onBlur;return(0,a.jsx)(u.Z,{label:"\u0634\u0645\u0627\u0631\u0647 \u0645\u0627\u0646\u06cc\u0641\u0633\u062a",value:r,onBlur:i,onChange:t,error:Boolean(L.manifest_number),disabled:x,dir:"ltr"})}}),L.manifest_number&&(0,a.jsx)(m.Z,{sx:{color:"error.main"},children:L.manifest_number.message})]})}),(0,a.jsx)(M.ZP,{item:!0,xs:12,sm:12,md:6,lg:3,xl:3,children:(0,a.jsxs)(p.Z,{fullWidth:!0,sx:{mb:4},children:[(0,a.jsx)(g.Qr,{name:"logistic_id",control:U,rules:{required:!0},render:function(e){var n=e.field,r=n.onChange,t=n.onBlur;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{children:"\u0644\u0627\u062c\u0633\u062a\u06cc\u06a9"}),(0,a.jsx)(P.Z,{type:"number",onBlur:t,id:"demo-multiple-name",onChange:r,input:(0,a.jsx)(C.Z,{label:"Name"}),error:Boolean(L.logistic_id),children:0===te.length?(0,a.jsx)(S.Z,{value:void 0,children:"\u0644\u0627\u062c\u0633\u062a\u06cc\u06a9 \u0645\u0648\u062c\u0648\u062f \u0646\u06cc\u0633\u062a"}):te.map((function(e){return(0,a.jsxs)(S.Z,{value:parseInt(e.id,10),disabled:0===e.id,children:[e.name,"(",e.id,")"]},e.id)}))})]})}}),L.logistic_id&&(0,a.jsx)(m.Z,{sx:{color:"error.main"},children:L.logistic_id.message})]})}),(0,a.jsx)(M.ZP,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,children:(0,a.jsx)(D.default,{setCustomer:J,customer:X,data:$,setData:ee,user:c})}),!x&&(0,a.jsx)(M.ZP,{item:!0,xs:12,sm:12,md:6,lg:3,xl:3,children:(0,a.jsx)(l.Z,{size:"large",type:"submit",variant:"contained",sx:{mr:3},fullWidth:!0,children:"\u0630\u062e\u06cc\u0631\u0647"})})]})})}),(0,a.jsxs)(b.Z,{open:W,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,a.jsx)(j.Z,{id:"alert-dialog-title",children:"\u0627\u06cc\u062c\u0627\u062f \u0647\u0627\u0628"}),(0,a.jsx)(y.Z,{children:(0,a.jsx)(w.Z,{id:"alert-dialog-description",children:"\u0647\u0627\u0628 \u0645\u0648\u0631\u062f \u0646\u0638\u0631 \u0627\u06cc\u062c\u0627\u062f \u0634\u062f"})}),(0,a.jsx)(Z.Z,{children:(0,a.jsx)(l.Z,{onClick:function(){A(!1),t(!0)},children:"\u0645\u062a\u0648\u062c\u0647 \u0634\u062f\u0645"})})]})]})}},91453:function(e,n,r){r.r(n),r.d(n,{default:function(){return g},deleteUser:function(){return p},downloadDataFromServer:function(){return f},fetchData:function(){return d},fetchManifest:function(){return m},fetchNoManifest:function(){return x},registerUser:function(){return h}});var t=r(34051),i=r.n(t),a=r(85893),o=r(5370),s=r(63543);function l(e,n,r,t,i,a,o){try{var s=e[a](o),l=s.value}catch(c){return void r(c)}s.done?n(l):Promise.resolve(l).then(t,i)}function c(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function o(e){l(a,t,i,o,s,"next",e)}function s(e){l(a,t,i,o,s,"throw",e)}o(void 0)}))}}var u={asc:1,desc:0},d=function(){var e=c(i().mark((function e(n,r){var t,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=n.sort_by.split(" "))[1]=u[t[1]],e.next=4,o.Z.post(s.Z.manifestPage(n.page,Number(t.join(""))),r,{Authorization:"Bearer ".concat(window.localStorage.getItem("access_Token"))});case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),f=function(){var e=c(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.post(s.Z.manifestReport,{},{Authorization:"Bearer ".concat(window.localStorage.getItem("access_Token"))});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=c(i().mark((function e(n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.delete(s.Z.singleManifest(n),{Authorization:"Bearer ".concat(window.localStorage.getItem("access_Token"))});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),m=function(){var e=c(i().mark((function e(n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get(s.Z.singleManifest(n),{},{Authorization:"Bearer ".concat(window.localStorage.getItem("access_Token"))});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),x=function(){var e=c(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get(s.Z.noManifest,{},{Authorization:"Bearer ".concat(window.localStorage.getItem("access_Token"))});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=c(i().mark((function e(n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.post(s.Z.addManifest,n,{Authorization:"Bearer ".concat(window.localStorage.getItem("access_Token"))});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function g(){return(0,a.jsx)("div",{})}},18043:function(e,n,r){r.r(n),r.d(n,{GridContainer:function(){return g}});var t=r(85893),i=r(67294),a=r(3512),o=r(11888),s=r(4718),l=r(50853),c=r(79172),u=r(15861),d=r(74931),f=r(11496),p=r(55113),m=r(91453);function x(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function h(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){x(e,n,r[n])}))}return e}var g=(0,f.ZP)(p.Z)({flexGrow:1,".MuiDataGrid-root":{border:"none"},".MuiTablePagination-displayedRows":{display:"none"}});n.default=function(e){var n=e.setCustomer,r=e.customer,f=e.data,p=e.setData,v=(0,i.useState)({page:1,page_size:100,sort_by:"1 id asc",search:""}),b=v[0],j=v[1],y=(0,i.useState)(10),Z=y[0],w=y[1],_=(0,i.useState)(0),k=_[0],P=_[1];(0,i.useEffect)((function(){d.ZP.promise((0,m.fetchNoManifest)().then((function(e){null===e.data?p([]):p(e.data)})),{loading:"\u062f\u0631 \u062d\u0627\u0644 \u062f\u0631\u06cc\u0627\u0641\u062a \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0628\u0627\u0631\u0646\u0627\u0645\u0647 \u0647\u0627",success:"\u0628\u0627\u0631\u0646\u0627\u0645\u0647 \u0631\u0627 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f",error:function(e){var n,r,t,i;return(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)?null===(t=e.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.message:"\u062e\u0637\u0627\u06cc\u06cc \u0631\u062e \u062f\u0627\u062f\u0647 \u0627\u0633\u062a."}})}),[b]);var C=(0,a.s)().filter((function(e){var n=e.value;return["contains"].includes(n)})),S=[{flex:.1,field:"1",minWidth:50,headerName:"\u0634\u0645\u0627\u0631\u0647 \u0628\u0627\u0631\u0646\u0627\u0645\u0647",filterable:!1,hideable:!1,sortable:!1,renderCell:function(e){var n=e.row;return(0,t.jsx)(c.Z,{sx:{display:"flex",alignItems:"center"},children:(0,t.jsx)(u.Z,{noWrap:!0,sx:{color:"text.secondary",textTransform:"capitalize"},children:n.generated_id})})}},{flex:.1,minWidth:50,field:"id",headerName:"\u0641\u0631\u0633\u062a\u0646\u062f\u0647",sortable:!1,filterOperators:C,hideable:!1,renderCell:function(e){var n=e.row;return(0,t.jsx)(c.Z,{sx:{display:"flex",alignItems:"center"},children:(0,t.jsx)(c.Z,{sx:{display:"flex",alignItems:"flex-start",flexDirection:"column"},children:(0,t.jsx)(u.Z,{noWrap:!0,component:"a",variant:"subtitle2",sx:{color:"text.primary",textDecoration:"none"},children:n.sender_name})})})}},{flex:.1,minWidth:50,field:"2",headerName:" \u0645\u0628\u062f\u0627",sortable:!1,filterOperators:C,hideable:!1,renderCell:function(e){var n=e.row;return(0,t.jsx)(c.Z,{sx:{display:"flex",alignItems:"center"},children:(0,t.jsx)(c.Z,{sx:{display:"flex",alignItems:"flex-start",flexDirection:"column"},children:(0,t.jsx)(u.Z,{noWrap:!0,component:"a",variant:"subtitle2",sx:{color:"text.primary",textDecoration:"none"},children:n.sender_city})})})}},{flex:.1,field:"4",minWidth:50,headerName:"\u06af\u06cc\u0631\u0646\u062f\u0647",filterOperators:C,hideable:!1,sortable:!1,renderCell:function(e){var n=e.row;return(0,t.jsx)(c.Z,{sx:{display:"flex",alignItems:"center"},children:(0,t.jsx)(u.Z,{noWrap:!0,sx:{color:"text.secondary",textTransform:"capitalize"},children:n.receiver_name})})}},{flex:.1,minWidth:50,field:"3",headerName:"\u0645\u0642\u0635\u062f",sortable:!1,hideable:!1,filterOperators:C,renderCell:function(e){var n=e.row;return(0,t.jsx)(c.Z,{sx:{display:"flex",alignItems:"center"},children:(0,t.jsx)(c.Z,{sx:{display:"flex",alignItems:"flex-start",flexDirection:"column"},children:(0,t.jsx)(u.Z,{noWrap:!0,component:"a",variant:"subtitle2",sx:{color:"text.primary",textDecoration:"none"},children:n.sender_city})})})}}],M=(0,i.useState)({}),O=M[0],I=M[1],D=(0,i.useCallback)((function(e){var n,r;(I(e),0!==Object.keys(e).length&&void 0!==(null===(n=e.items[0])||void 0===n?void 0:n.value))?j(h({},b,{search:x({},e.items[0].columnField.split(" ")[1],null===(r=e.items[0])||void 0===r?void 0:r.value)})):j(h({},b,{search:""}))}),[O,I]);return(0,t.jsx)(g,{sx:{p:4,m:1},children:(0,t.jsx)(o._,{autoHeight:!0,pagination:!0,rows:f,columns:S,pageSize:Z,disableSelectionOnClick:!0,rowsPerPageOptions:[100],sx:{"& .MuiDataGrid-columnHeaders":{borderRadius:0}},onSelectionModelChange:function(e){n(e)},paginationMode:"server",onPageSizeChange:function(e){w(e),j(h({},b,{page_size:e}))},localeText:s.T.components.MuiDataGrid.defaultProps.localeText,checkboxSelection:!0,selectionModel:r,sortingMode:"server",onSortModelChange:function(e){var n,r,t=0!==e.length?"".concat(null===(n=e[0])||void 0===n?void 0:n.field," ").concat(null===(r=e[0])||void 0===r?void 0:r.sort):"1 id asc";j(h({},b,{sort_by:"".concat(t)}))},onPageChange:function(e){P(e),j(h({},b,{page:e+1}))},page:k,rowCount:50,onFilterModelChange:D,components:{Toolbar:l.M}})})}}}]);